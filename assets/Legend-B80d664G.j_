import{d as D,i as R,aa as T,g as v,u as x,Q as f,o as p,C as L,K as m,L as C}from"./ResponsiveTheme-Ck20dRLL.js";class k extends D{_beforeChanged(){super._beforeChanged(),(this.isDirty("cornerRadiusTL")||this.isDirty("cornerRadiusTR")||this.isDirty("cornerRadiusBR")||this.isDirty("cornerRadiusBL"))&&(this._clear=!0)}_draw(){let e=this.width(),s=this.height(),r=e,a=s,h=r/Math.abs(e),c=a/Math.abs(s);if(R(r)&&R(a)){let t=Math.min(r,a)/2,n=T(this.get("cornerRadiusTL",8),t),o=T(this.get("cornerRadiusTR",8),t),u=T(this.get("cornerRadiusBR",8),t),i=T(this.get("cornerRadiusBL",8),t),g=Math.min(Math.abs(r/2),Math.abs(a/2));n=v(n,0,g),o=v(o,0,g),u=v(u,0,g),i=v(i,0,g);const l=this._display;l.moveTo(n*h,0),l.lineTo(r-o*h,0),o>0&&l.arcTo(r,0,r,o*c,o),l.lineTo(r,a-u*c),u>0&&l.arcTo(r,a,r-u*h,a,u),l.lineTo(i*h,a),i>0&&l.arcTo(0,a,0,a-i*c,i),l.lineTo(0,n*c),n>0&&l.arcTo(0,0,n*h,0,n),l.closePath()}}}Object.defineProperty(k,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RoundedRectangle"});Object.defineProperty(k,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:D.classNames.concat([k.className])});class w extends x{constructor(){super(...arguments),Object.defineProperty(this,"itemContainers",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new f(p.new({}),()=>L._new(this._root,{themeTags:m(this.itemContainers.template.get("themeTags",[]),["legend","item"]),themeTagsSelf:m(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"]),background:k.new(this._root,{themeTags:m(this.itemContainers.template.get("themeTags",[]),["legend","item","background"]),themeTagsSelf:m(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"])})},[this.itemContainers.template])))}),Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new f(p.new({}),()=>L._new(this._root,{themeTags:m(this.markers.template.get("themeTags",[]),["legend","marker"])},[this.markers.template])))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new f(p.new({}),()=>C._new(this._root,{themeTags:m(this.labels.template.get("themeTags",[]),["legend","label"])},[this.labels.template])))}),Object.defineProperty(this,"valueLabels",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new f(p.new({}),()=>C._new(this._root,{themeTags:m(this.valueLabels.template.get("themeTags",[]),["legend","label","value"])},[this.valueLabels.template])))}),Object.defineProperty(this,"markerRectangles",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new f(p.new({}),()=>k._new(this._root,{themeTags:m(this.markerRectangles.template.get("themeTags",[]),["legend","marker","rectangle"])},[this.markerRectangles.template])))})}_afterNew(){this._settings.themeTags=m(this._settings.themeTags,["legend"]),this.fields.push("name","stroke","fill"),super._afterNew()}makeItemContainer(e){const s=this.children.push(this.itemContainers.make());return s._setDataItem(e),this.itemContainers.push(s),s.states.create("disabled",{}),s}makeMarker(){const e=this.markers.make();return this.markers.push(e),e.states.create("disabled",{}),e}makeLabel(){const e=this.labels.make();return e.states.create("disabled",{}),e}makeValueLabel(){const e=this.valueLabels.make();return e.states.create("disabled",{}),e}makeMarkerRectangle(){const e=this.markerRectangles.make();return e.states.create("disabled",{}),e}processDataItem(e){super.processDataItem(e);const s=this.makeItemContainer(e),r=this.get("nameField"),a=this.get("fillField"),h=this.get("strokeField");if(s){const c=this.get("clickTarget","itemContainer"),t=e.dataContext;t&&t.set&&t.set("legendDataItem",e),s._setDataItem(e),e.set("itemContainer",s);const n=this.makeMarker();if(n){s.children.push(n),n._setDataItem(e),e.set("marker",n);const i=this.get("useDefaultMarker"),g=n.children.push(this.makeMarkerRectangle());let l=e.get("fill"),d=e.get("stroke");e.set("markerRectangle",g),t&&t.get&&(l=t.get(a,l),d=t.get(h,d)),d||(d=l),i?t.on&&(t.on(a,()=>{g.set("fill",t.get(a))}),t.on(h,()=>{g.set("stroke",t.get(h))})):t&&t.createLegendMarker&&t.createLegendMarker(),g.setAll({fill:l,stroke:d});const b=t.component;b&&b.updateLegendMarker&&b.updateLegendMarker(t)}const o=this.makeLabel();if(o){s.children.push(o),o._setDataItem(e),e.set("label",o),o.text.on("text",()=>{s.setRaw("ariaLabel",o.text._getText()+(this.get("clickTarget")!=="none"?"; "+this._t("Press ENTER to toggle"):"")),s.markDirtyAccessibility()}),t&&t.get&&e.set("name",t.get(r));let i=e.get("name");i&&o.set("text",i)}const u=this.makeValueLabel();if(u&&(s.children.push(u),u._setDataItem(e),e.set("valueLabel",u)),t&&t.show&&(t.on("visible",i=>{s.set("disabled",!i)}),t.get("visible")||s.set("disabled",!0),c!="none")){let i=s;c=="marker"&&(i=n),this._addClickEvents(i,t,e)}this.children.values.sort((i,g)=>{const l=i.dataItem.dataContext,d=g.dataItem.dataContext;if(l&&d){const b=this.data.indexOf(l),_=this.data.indexOf(d);if(b>_)return 1;if(b<_)return-1}return 0}),t&&t.updateLegendValue&&t.updateLegendValue()}}_addClickEvents(e,s,r){e.set("cursorOverStyle","pointer"),e.events.on("pointerover",()=>{const a=s.component;a&&a.hoverDataItem&&a.hoverDataItem(s)}),e.events.on("pointerout",()=>{const a=s.component;a&&a.hoverDataItem&&a.unhoverDataItem(s)}),e.events.on("click",()=>{const a=r.get("label").text._getText();s.show&&s.isHidden&&(s.isHidden()||s.get("visible")===!1)?(s.show(),e.set("disabled",!1),this._root.readerAlert(this._t("%1 shown",this._root.locale,a))):s.hide&&(s.hide(),e.set("disabled",!0),this._root.readerAlert(this._t("%1 hidden",this._root.locale,a)))})}disposeDataItem(e){super.disposeDataItem(e);const s=e.dataContext;s&&s.get&&s.get("legendDataItem")==e&&s.set("legendDataItem",void 0);let r=e.get("itemContainer");r&&(this.itemContainers.removeValue(r),r.dispose());let a=e.get("marker");a&&(this.markers.removeValue(a),a.dispose());let h=e.get("markerRectangle");h&&(this.markerRectangles.removeValue(h),h.dispose());let c=e.get("label");c&&(this.labels.removeValue(c),c.dispose());let t=e.get("valueLabel");t&&(this.valueLabels.removeValue(t),t.dispose())}}Object.defineProperty(w,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Legend"});Object.defineProperty(w,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:x.classNames.concat([w.className])});export{w as L,k as R};
