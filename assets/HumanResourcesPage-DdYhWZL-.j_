import{Q as ze}from"./QPage-DAomX7La.js";import{Q as Le}from"./QSpinnerDots-B_-BC47s.js";import{Q as Ae}from"./QBanner-Bh0a8mRE.js";import{a6 as le,am as Me,H as ne,aA as Ne,Y as Ze,J as Qe,aq as oe,a8 as H,a7 as De,aa as ue,ak as Z,ab as h,a9 as g,ad as z,ae as Be,aB as Re,af as Ee,ap as Y,aE as Fe,an as ce,Z as He,aF as Ye,aG as U,ax as qe}from"./index-Bhl6SETv.js";import{C as L,d as Ce,e as de,c as P,i as he,f as Ge,g as Xe,k as pe,h as ae,G as K,M as Ve,s as We,j as C,r as ee,D as Je,l as $e,L as Oe,m as Ue,n as Ke,R as et,A as tt,a as st,T as rt,p as E,b as it,o as nt,q as fe}from"./ResponsiveTheme-Ck20dRLL.js";import{u as ot,M as at,g as lt,a as ut}from"./useGeoJson-DGaBucA4.js";import{u as ct}from"./useRegionEducation-B3UyvXDC.js";import{u as dt}from"./useMapContainerSize-BlGOuocN.js";import{B as te}from"./Button-D2zITozv.js";import{M as ke}from"./MapPointSeries-C4I4MaBM.js";import{C as G,B as me}from"./Circle-CGqZXLub.js";import{L as ht}from"./Legend-B80d664G.js";import{_ as Te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as pt}from"./QTooltip-D8T5Kzqq.js";import{Q as ft,C as mt}from"./ClosePopup-ByZL18Fk.js";import{Q as ge}from"./QCardSection-CIRpBG4M.js";import{Q as se,a as B,b as R}from"./QItem-DIgVajpF.js";import{Q as gt}from"./QList-Bzp8q5wm.js";import{Q as bt}from"./QCard-4hNWPW3w.js";import{Q as yt}from"./QDialog-DwvcyMya.js";import"./use-dark-CCCGl-by.js";import"./position-engine-CD8Qv4MV.js";import"./use-tick-0DdASRGW.js";import"./use-model-toggle-DypRWqPB.js";class W extends L{constructor(){super(...arguments),Object.defineProperty(this,"_za",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_txa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tya",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_movePoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_downScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_downX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_downY",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pinchDP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contents",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(L.new(this._root,{width:de,height:de,x:0,y:0,draggable:!0,background:Ce.new(this._root,{fill:P(16777215),fillOpacity:0})}))}),Object.defineProperty(this,"_wheelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew();const r=this.contents.events;this._disposers.push(r.on("pointerdown",s=>{this._handleThisDown(s)})),this._disposers.push(r.on("globalpointerup",s=>{this._handleThisUp(s)})),this._disposers.push(r.on("globalpointermove",s=>{this._handleThisMove(s)}));const e=this.contents.get("background");e&&(e.adapters.add("width",s=>Number(s)*20),e.adapters.add("height",s=>Number(s)*20),e.adapters.add("x",s=>Number(s)-e.width()/2),e.adapters.add("y",s=>Number(s)-e.height()/2));const t=this.contents;t.adapters.add("x",s=>{const n=t.get("scale",1);if(he(s)&&n>=1){let o=this.get("maxPanOut",.4),a=t.width();s=Math.min(a*o,s),s=Math.max(this.width()-a*n*(1+o),s)}return s}),t.adapters.add("y",s=>{const n=t.get("scale",1);if(he(s)&&n>=1){let o=this.get("maxPanOut",.4),a=t.height();s=Math.min(a*o,s),s=Math.max(this.height()-a*n*(1+o),s)}return s})}_prepareChildren(){super._prepareChildren(),this.isDirty("wheelable")&&this._handleSetWheel(),this.contents._display.cancelTouch=this.get("pinchZoom",!1)}_handleSetWheel(){this.get("wheelable")?(this._wheelDp&&this._wheelDp.dispose(),this._wheelDp=this.events.on("wheel",r=>{const e=r.originalEvent;if(Ge(e,this))e.preventDefault();else return;const t=this.toLocal(r.point);this._handleWheelZoom(e.deltaY,t)}),this._disposers.push(this._wheelDp)):this._wheelDp&&this._wheelDp.dispose()}_handleWheelZoom(r,e){let t=this.get("zoomStep",2),s=this.contents.get("scale",1),n=s;r>0?n=s/t:r<0&&(n=s*t),n!=s&&this.zoomToPoint(e,n)}zoomToPoint(r,e){e&&(e=Xe(e,this.get("minZoomLevel",1),this.get("maxZoomLevel",32)));const t=this.contents.get("scale",1);let s=r.x,n=r.y,o=s,a=n;const l=this.contents;let u=l.x(),d=l.y(),m=o-(s-u)/t*e,b=a-(n-d)/t*e;return this._animateTo(m,b,e),this._za}zoomIn(){return this.zoomToPoint({x:this.width()/2,y:this.height()/2},this.contents.get("scale",1)*this.get("zoomStep",2))}zoomOut(){return this.zoomToPoint({x:this.width()/2,y:this.height()/2},this.contents.get("scale",1)/this.get("zoomStep",2))}goHome(){return this._animateTo(0,0,1)}_animateTo(r,e,t){const s=this.get("animationDuration",0),n=this.get("animationEasing"),o=this.contents;this._txa=o.animate({key:"x",to:r,duration:s,easing:n}),this._tya=o.animate({key:"y",to:e,duration:s,easing:n}),this._za=o.animate({key:"scale",to:t,duration:s,easing:n})}_handleThisUp(r){this._downPoints={}}_handleThisDown(r){const e=this.contents;this._downScale=e.get("scale",1);const t=e._downPoints;let s=pe(t).length;if(s==1){let n=t[1];n||(n=t[0]),n&&n.x==r.point.x&&n.y==r.point.y&&(s=0)}if(s>0){this._downX=e.x(),this._downY=e.y();const n=e._getDownPointId();if(n){let o=this._movePoints[n];o&&(e._downPoints[n]=o)}}}_handleThisMove(r){const t=r.originalEvent.pointerId;if(this.get("pinchZoom")&&t&&(this._movePoints[t]=r.point,pe(this.contents._downPoints).length>1)){this._handlePinch();return}}_handlePinch(){let r=0,e=[],t=[];if(ae(this.contents._downPoints,(s,n)=>{e[r]=n;let o=this._movePoints[s];o&&(t[r]=o),r++}),e.length>1&&t.length>1){this.contents._isDragging=!1;let s=e[0],n=e[1],o=t[0],a=t[1];if(s&&n&&o&&a){s=this.toLocal(s),n=this.toLocal(n),o=this.toLocal(o),a=this.toLocal(a);let l=Math.hypot(n.x-s.x,n.y-s.y),d=Math.hypot(a.x-o.x,a.y-o.y)/l*this._downScale,m={x:o.x+(a.x-o.x)/2,y:o.y+(a.y-o.y)/2},b={x:s.x+(n.x-s.x)/2,y:s.y+(n.y-s.y)/2},I=this._downX||0,k=this._downY||0,y=this._downScale,w=m.x-(-I+b.x)/y*d,O=m.y-(-k+b.y)/y*d;this.contents.setAll({x:w,y:O,scale:d})}}}}Object.defineProperty(W,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ZoomableContainer"});Object.defineProperty(W,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:L.classNames.concat([W.className])});class q extends L{constructor(){super(...arguments),Object.defineProperty(this,"homeButton",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(te.new(this._root,{width:35,height:35,themeTags:["home"]}))}),Object.defineProperty(this,"plusButton",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(te.new(this._root,{width:35,height:35,themeTags:["plus"]}))}),Object.defineProperty(this,"minusButton",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(te.new(this._root,{width:35,height:35,themeTags:["minus"]}))}),Object.defineProperty(this,"_disposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targetDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew(),this.set("position","absolute"),this.set("layout",this._root.verticalLayout),this.addTag("zoomtools"),this.plusButton.setAll({icon:K.new(this._root,{themeTags:["icon"]}),layout:void 0}),this.minusButton.setAll({icon:K.new(this._root,{themeTags:["icon"]}),layout:void 0}),this.homeButton.setAll({icon:K.new(this._root,{themeTags:["icon"]}),layout:void 0})}_prepareChildren(){if(super._prepareChildren(),this.isDirty("target")){const r=this.get("target"),e=this._prevSettings.target;r&&(r instanceof W&&(this._targetDisposer=this.addDisposer(r.contents.on("scale",t=>{t==r.get("minZoomLevel")?this.minusButton.set("disabled",!0):this.minusButton.set("disabled",!1),t==r.get("maxZoomLevel")?this.plusButton.set("disabled",!0):this.plusButton.set("disabled",!1)})),this.root.events.once("frameended",()=>{r.get("scale")==r.get("minZoomLevel")&&this.minusButton.set("disabled",!0)})),this._disposer=new Ve([this.plusButton.events.on("click",()=>{r.zoomIn()}),this.minusButton.events.on("click",()=>{r.zoomOut()}),this.homeButton.events.on("click",()=>{r.goHome()})])),e&&(this._disposer&&this._disposer.dispose(),this._targetDisposer&&this._targetDisposer.dispose())}}}Object.defineProperty(q,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ZoomTools"});Object.defineProperty(q,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:L.classNames.concat([q.className])});function _t(i){return i==null?null:vt(i)}function vt(i){if(typeof i!="function")throw new Error;return i}function be(){return 0}function xt(i){return function(){return i}}const wt=1664525,Pt=1013904223,ye=4294967296;function Dt(){let i=1;return()=>(i=(wt*i+Pt)%ye)/ye}function Ct(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function Ot(i,r){let e=i.length,t,s;for(;e;)s=r()*e--|0,t=i[e],i[e]=i[s],i[s]=t;return i}function kt(i,r){for(var e=0,t=(i=Ot(Array.from(i),r)).length,s=[],n,o;e<t;)n=i[e],o&&Ie(o,n)?++e:(o=It(s=Tt(s,n)),e=0);return o}function Tt(i,r){var e,t;if(re(r,i))return[r];for(e=0;e<i.length;++e)if(X(r,i[e])&&re(F(i[e],r),i))return[i[e],r];for(e=0;e<i.length-1;++e)for(t=e+1;t<i.length;++t)if(X(F(i[e],i[t]),r)&&X(F(i[e],r),i[t])&&X(F(i[t],r),i[e])&&re(Se(i[e],i[t],r),i))return[i[e],i[t],r];throw new Error}function X(i,r){var e=i.r-r.r,t=r.x-i.x,s=r.y-i.y;return e<0||e*e<t*t+s*s}function Ie(i,r){var e=i.r-r.r+Math.max(i.r,r.r,1)*1e-9,t=r.x-i.x,s=r.y-i.y;return e>0&&e*e>t*t+s*s}function re(i,r){for(var e=0;e<r.length;++e)if(!Ie(i,r[e]))return!1;return!0}function It(i){switch(i.length){case 1:return St(i[0]);case 2:return F(i[0],i[1]);case 3:return Se(i[0],i[1],i[2])}}function St(i){return{x:i.x,y:i.y,r:i.r}}function F(i,r){var e=i.x,t=i.y,s=i.r,n=r.x,o=r.y,a=r.r,l=n-e,u=o-t,d=a-s,m=Math.sqrt(l*l+u*u);return{x:(e+n+l/m*d)/2,y:(t+o+u/m*d)/2,r:(m+s+a)/2}}function Se(i,r,e){var t=i.x,s=i.y,n=i.r,o=r.x,a=r.y,l=r.r,u=e.x,d=e.y,m=e.r,b=t-o,I=t-u,k=s-a,y=s-d,w=l-n,O=m-n,Q=t*t+s*s-n*n,A=Q-o*o-a*a+l*l,c=Q-u*u-d*d+m*m,T=I*k-b*y,p=(k*c-y*A)/(T*2)-t,D=(y*w-k*O)/T,M=(I*A-b*c)/(T*2)-s,_=(b*O-I*w)/T,f=D*D+_*_-1,S=2*(n+p*D+M*_),v=p*p+M*M-n*n,x=-(Math.abs(f)>1e-6?(S+Math.sqrt(S*S-4*f*v))/(2*f):v/S);return{x:t+p+D*x,y:s+M+_*x,r:x}}function _e(i,r,e){var t=i.x-r.x,s,n,o=i.y-r.y,a,l,u=t*t+o*o;u?(n=r.r+e.r,n*=n,l=i.r+e.r,l*=l,n>l?(s=(u+l-n)/(2*u),a=Math.sqrt(Math.max(0,l/u-s*s)),e.x=i.x-s*t-a*o,e.y=i.y-s*o+a*t):(s=(u+n-l)/(2*u),a=Math.sqrt(Math.max(0,n/u-s*s)),e.x=r.x+s*t-a*o,e.y=r.y+s*o+a*t)):(e.x=r.x+e.r,e.y=r.y)}function ve(i,r){var e=i.r+r.r-1e-6,t=r.x-i.x,s=r.y-i.y;return e>0&&e*e>t*t+s*s}function xe(i){var r=i._,e=i.next._,t=r.r+e.r,s=(r.x*e.r+e.x*r.r)/t,n=(r.y*e.r+e.y*r.r)/t;return s*s+n*n}function V(i){this._=i,this.next=null,this.previous=null}function jt(i,r){if(!(n=(i=Ct(i)).length))return 0;var e,t,s,n,o,a,l,u,d,m,b;if(e=i[0],e.x=0,e.y=0,!(n>1))return e.r;if(t=i[1],e.x=-t.r,t.x=e.r,t.y=0,!(n>2))return e.r+t.r;_e(t,e,s=i[2]),e=new V(e),t=new V(t),s=new V(s),e.next=s.previous=t,t.next=e.previous=s,s.next=t.previous=e;e:for(l=3;l<n;++l){_e(e._,t._,s=i[l]),s=new V(s),u=t.next,d=e.previous,m=t._.r,b=e._.r;do if(m<=b){if(ve(u._,s._)){t=u,e.next=t,t.previous=e,--l;continue e}m+=u._.r,u=u.next}else{if(ve(d._,s._)){e=d,e.next=t,t.previous=e,--l;continue e}b+=d._.r,d=d.previous}while(u!==d.next);for(s.previous=e,s.next=t,e.next=t.previous=t=s,o=xe(e);(s=s.next)!==t;)(a=xe(s))<o&&(e=s,o=a);t=e.next}for(e=[t._],s=t;(s=s.next)!==t;)e.push(s._);for(s=kt(e,r),l=0;l<n;++l)e=i[l],e.x-=s.x,e.y-=s.y;return s.r}function zt(i){return Math.sqrt(i.value)}function Lt(){var i=null,r=1,e=1,t=be;function s(n){const o=Dt();return n.x=r/2,n.y=e/2,i?n.eachBefore(we(i)).eachAfter(ie(t,.5,o)).eachBefore(Pe(1)):n.eachBefore(we(zt)).eachAfter(ie(be,1,o)).eachAfter(ie(t,n.r/Math.min(r,e),o)).eachBefore(Pe(Math.min(r,e)/(2*n.r))),n}return s.radius=function(n){return arguments.length?(i=_t(n),s):i},s.size=function(n){return arguments.length?(r=+n[0],e=+n[1],s):[r,e]},s.padding=function(n){return arguments.length?(t=typeof n=="function"?n:xt(+n),s):t},s}function we(i){return function(r){r.children||(r.r=Math.max(0,+i(r)||0))}}function ie(i,r,e){return function(t){if(s=t.children){var s,n,o=s.length,a=i(t)*r||0,l;if(a)for(n=0;n<o;++n)s[n].r+=a;if(l=jt(s,e),a)for(n=0;n<o;++n)s[n].r-=a;t.r=l+a}}}function Pe(i){return function(r){var e=r.parent;r.r*=i,e&&(r.x=e.x+i*r.x,r.y=e.y+i*r.y)}}class J extends ke{constructor(){super(...arguments),Object.defineProperty(this,"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:this.makeDataItem({})}),Object.defineProperty(this,"_clusterIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_clusters",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"clusteredDataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_scatterIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_scatters",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_packLayout",{enumerable:!0,configurable:!0,writable:!0,value:Lt()}),Object.defineProperty(this,"_spiral",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_clusterDP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_previousZL",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){this.fields.push("groupId"),this._setRawDefault("groupIdField","groupId"),super._afterNew()}_updateChildren(){super._updateChildren(),this.isDirty("scatterRadius")&&(this._spiral=We(0,0,300,300,0,3,3,0,0));const r=this.chart;if(r){const e=r.get("zoomLevel",1);if(e!=this._previousZL){const t=this.get("clusterDelay",0);t?this._clusterDP?(this._clusterDP.dispose(),this._clusterDP=this.setTimeout(()=>{this._doTheCluster()},t)):(this._doTheCluster(),this._clusterDP=this.setTimeout(()=>{},0)):this._doTheCluster(),this._previousZL=e}C(this.clusteredDataItems,t=>{const s=t.get("bullet"),n=t.get("longitude",0),o=t.get("latitude",0);this._positionBulletReal(s,{type:"Point",coordinates:[n,o]},[n,o])})}}_doTheCluster(){const r={};C(this.dataItems,e=>{const t=e.get("groupId","_default");r[t]||(r[t]=[]),r[t].push(e)}),this._scatterIndex=-1,this._scatters=[],this._clusterIndex=-1,this._clusters=[],C(this.clusteredDataItems,e=>{e.setRaw("children",void 0)}),C(this.dataItems,e=>{e.setRaw("cluster",void 0)}),ae(r,(e,t)=>{this._scatterGroup(t)}),ae(r,(e,t)=>{this._clusterGroup(t)}),C(this.dataItems,e=>{if(!e.get("cluster")){const t=e.bullets;t&&C(t,s=>{const n=s.get("sprite");n&&n.set("forceHidden",!1)})}})}zoomToCluster(r,e){this.zoomToDataItems(r.get("children",[]),e)}_clusterGroup(r){const e=this.chart;if(!(e&&e.get("zoomLevel",1)>=e.get("maxZoomLevel",100)*this.get("stopClusterZoom",.95)))for(r.sort((n,o)=>{const a=n.get("point"),l=o.get("point");return a&&l?Math.hypot(a.x-l.x,a.y-l.y):0});r.length>0;){this._clusterIndex++,this._clusters[this._clusterIndex]=[];const n=this._clusters[this._clusterIndex],o=r[0];n.push(o),ee(r,o),this._clusterDataItem(o,r)}let t=0;const s=this.get("clusteredBullet");s&&C(this._clusters,n=>{let o=0,a=0,l=n.length;if(l>1){let u=this.clusteredDataItems[t];if(!u){u=new Je(this,void 0,{});const y=u.set("bullet",s(this._root,this,u));if(y){const w=y.get("sprite");w&&(this.bulletsContainer.children.push(w),w._setDataItem(u),this.root.events.once("frameended",()=>{w instanceof L&&w.walkChildren(O=>{O instanceof $e&&O.markDirtyValues()})}))}this.clusteredDataItems.push(u)}let d;C(n,y=>{y.setRaw("cluster",u);const w=y.get("point");w&&(o+=w.x,a+=w.y);const O=y.bullets;O&&C(O,Q=>{const A=Q.get("sprite");A&&A.set("forceHidden",!0)}),d=y.get("groupId")});let m=o/l,b=a/l;u.setRaw("children",n),u.setRaw("groupId",d);const I=u.get("value");u.setRaw("value",l);const k=u.get("bullet");if(k){let y=this.chart.invert({x:m,y:b});y&&u.setAll({longitude:y.longitude,latitude:y.latitude}),this._positionBullets(u);const w=k.get("sprite");w&&(w.set("forceHidden",!1),I!=l&&w instanceof L&&w.walkChildren(O=>{O instanceof Oe&&O.text.markDirtyText()}))}t++}}),C(this.clusteredDataItems,n=>{let o=n.get("children");if(!o||o.length==0){const a=n.get("bullet");if(a){const l=a.get("sprite");l&&l.set("forceHidden",!0)}}})}_onDataClear(){super._onDataClear(),C(this.clusteredDataItems,r=>{const e=r.get("bullet");if(e){const t=e.get("sprite");t&&t.dispose()}}),this.clusteredDataItems=[]}_clusterDataItem(r,e){const t=r.get("point");if(t){let s=this.get("minDistance",20);const n=this._clusters[this._clusterIndex];for(let o=e.length-1;o>=0;o--){const a=e[o];if(a&&!a.get("clipped")){const l=a.get("point");l&&Math.hypot(l.x-t.x,l.y-t.y)<s&&(n.push(a),ee(e,a),this._clusterDataItem(a,e))}}}}_scatterGroup(r){const e=this.chart;if(e&&e.get("zoomLevel",1)>=e.get("maxZoomLevel",100)*this.get("stopClusterZoom",.95)){for(;r.length>0;){this._scatterIndex++,this._scatters[this._scatterIndex]=[];const t=this._scatters[this._scatterIndex],s=r[0];t.push(s),Ue(r,s),this._scatterDataItem(s,r)}C(this._scatters,t=>{if(t.length>1){let n=[],o=0,a=this.get("scatterRadius",8);C(t,l=>{let u=this._spiral[o],d=!0;if(n.length>0)for(;d;)C(n,k=>{for(d=!1;Ke({x:u.x,y:u.y,radius:a},k);)o++,this._spiral[o]==null?d=!1:(d=!0,u=this._spiral[o])});const m=u.x,b=u.y;n.push({x:m,y:b,radius:a}),l.set("dx",m),l.set("dy",b);const I=l.bullets;I&&C(I,k=>{const y=k.get("sprite");y&&y.setAll({dx:m,dy:b})})})}})}}_scatterDataItem(r,e){const t=r.get("point");if(t){const s=this.get("scatterDistance",5),n=this._scatters[this._scatterIndex];C(e,o=>{if(o&&!o.get("clipped")){const a=o.get("point");a&&Math.hypot(a.x-t.x,a.y-t.y)<s&&(n.push(o),ee(e,o),this._scatterDataItem(o,e))}})}}}Object.defineProperty(J,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ClusteredPointSeries"});Object.defineProperty(J,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ke.classNames.concat([J.className])});class $ extends q{_afterNew(){super._afterNew(),this.addTag("zoomtools")}_prepareChildren(){super._prepareChildren(),this.isPrivateDirty("chart")&&this.set("target",this.getPrivate("chart"))}}Object.defineProperty($,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ZoomControl"});Object.defineProperty($,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([$.className])});const At={key:1,class:"error-message absolute-center"},Mt=le({__name:"MapRussiaHr",setup(i){const r=Me(),e=ne(null),t=ne(),s=Ne(),{fetchGeoJson:n,loading:o}=ot({defaultQuality:"Q0",cacheResults:!0}),{stats:a,bulletData:l,loading:u,fetchEducationGeoData:d}=ct(),{containerStyles:m}=dt({aspectRatio:16/9,maxHeight:"80vh",minHeight:"40vh"}),b={colors:{base:P(14540253),hover:P(2577549),bullet:{vo:P(4689007),dpo:P(15371264),mixed:P(2577549)}},legend:[{name:"Организации ВО",type:"vo"},{name:"Организации ДПО",type:"dpo"},{name:"Организации ВО/ДПО",type:"mixed"}]};async function I(){try{const[c]=await Promise.all([n(),d()]);if(!c)throw new Error("Не удалось загрузить гео-данные карты");if(!a.value.asList.length)throw new Error("Не удалось загрузить данные об образовательных учреждениях");return c}catch(c){throw e.value=c instanceof Error?c.message:"Неизвестная ошибка",console.error("Не удалось инициализировать данные карты:",e),e}}function k(c){c.setThemes([tt.new(c),st.new(c)]),c.numberFormatter.setAll({numberFormat:{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:4},intlLocales:"ru-RU"}),c.timezone=rt.new("Europe/Moscow"),c.tapToActivate=!0,c.tapToActivateTimeout=2e3}function y(c){return c.container.children.push(at.new(c,{projection:lt(),rotationX:-100,rotationY:-20,panX:"translateX",panY:"translateY",homeZoomLevel:1,paddingTop:30,paddingBottom:60,paddingLeft:10,paddingRight:10,height:E(95)}))}function w(c,T,p){const D=new Map;a.value.asList.forEach(v=>{v.id&&D.set(v.id,v)}),p.features&&p.features.forEach(v=>{const x=v.id;if(x&&!D.has(x)){const N={id:x,vo:0,dpo:0,mixed:0,total:0};D.set(x,N)}});const _=Array.from(D.values()).map(v=>{const x=p.features.find(N=>N.id===v.id);return{...v,name:x?.properties?.name||""}}),f=T.series.push(ut.new(c,{geoJSON:p,calculateAggregates:!0,valueField:"heatValue"}));f.mapPolygons.template.setAll({fill:b.colors.base,fillOpacity:.8,stroke:P(3355443),strokeWidth:.5,interactive:!1,tooltipPosition:"pointer",tooltipHTML:`
      <div class="text-center text-subtitle1 text-bold">{name}</div>
      <span class="block">Образовательных организаций: <span class="text-bold">{total}</span></span>
      ВО: <span class="text-bold">{vo}</span>,
      ДПО: <span class="text-bold">{dpo}</span>,
      ВО/ДПО: <span class="text-bold">{mixed}</span>
    `}),f.mapPolygons.template.adapters.add("tooltipHTML",(v,x)=>{if(typeof v!="string")return v;const N=x.dataItem;if(!N)return v;const j=N.dataContext;if(!j)return v;const je=j.name||N.dataContext?.properties?.name||"";return v.replace("{name}",je).replace("{total}",(typeof j.total=="number"?j.total:0).toString()).replace("{vo}",(typeof j.vo=="number"?j.vo:0).toString()).replace("{dpo}",(typeof j.dpo=="number"?j.dpo:0).toString()).replace("{mixed}",(typeof j.mixed=="number"?j.mixed:0).toString())});const S=it.new(c,{getFillFromSprite:!1,autoTextColor:!1,keepTargetHover:!1});return S.label.setAll({fill:P(2577549)}),S.get("background")?.setAll({fill:P(15658734),fillOpacity:.95,stroke:P(2577549),strokeOpacity:.95}),f.set("tooltip",S),f.mapPolygons.template.states.create("hover",{fillOpacity:1}),f.mapPolygons.template.events.on("click",v=>{const x=(v.target.dataItem?.dataContext).id;x&&r.push({name:"region",params:{id:x}})}),f.set("heatRules",[{target:f.mapPolygons.template,dataField:"value",min:P(11390975),max:P(2445978),key:"fill"}]),f.data.setAll(_),f}function O(c,T){const p=T.series.push(J.new(c,{groupIdField:"region_iso",minDistance:2,scatterDistance:5,scatterRadius:10,stopClusterZoom:.9,affectsBounds:!1})),D=nt.new({fill:P(15132390)});D.setAll({radius:8}),p.set("clusteredBullet",function(_){const f=L.new(_,{cursorOverStyle:"pointer"});return f.children.push(G.new(_,{radius:8,fill:P(39389)},D)),f.children.push(G.new(_,{radius:12,fillOpacity:.3,fill:P(39389)},D)),f.children.push(G.new(_,{radius:16,fillOpacity:.2,fill:P(39389)},D)),f.children.push(Oe.new(_,{centerX:fe,centerY:fe,fill:P(16777215),populateText:!0,fontSize:"0.8rem",text:"[bold]{value}[/]"})),f.events.on("click",S=>{p.zoomToCluster(S.target.dataItem,!1)}),me.new(_,{sprite:f})}),p.bullets.push(()=>{const _=G.new(c,{radius:6,tooltipY:0,templateField:"bulletSettings",tooltipHTML:'<div><div style="font-size: 0.8rem;max-width: 300px;line-height: 1" class="text-caption text-center text-bold ellipsis-3-lines">{title}</div><div class="text-center q-pt-sm">Программ ВО: <span class="text-bold">{vo}</span>, программ ДПО: <span class="text-bold">{dpo}</span></div></div>'},D);return _.adapters.add("tooltipHTML",(f,S)=>{const v=S.dataItem;if(!v)return f;const x=v.dataContext;return!x||typeof f!="string"?f:f.replace("{title}",x.title||"").replace("{vo}",(typeof x.vo=="number"?x.vo:0).toString()).replace("{dpo}",(typeof x.dpo=="number"?x.dpo:0).toString())}),me.new(c,{sprite:_})});const M=l.value.map(_=>({..._,vo:typeof _.vo=="number"?_.vo:0,dpo:typeof _.dpo=="number"?_.dpo:0,bulletSettings:{fill:b.colors.bullet[_.type],stroke:P(14540253)}}));return p.data.setAll(M),p}function Q(c,T){const p=T.children.push(ht.new(c,{nameField:"name",fillField:"color",strokeField:"color",x:E(50),centerX:E(50),y:E(100),centerY:E(0)}));p.set("background",Ce.new(c,{fill:P(16119285),fillOpacity:.7})),A(p),p.data.setAll(b.legend.map(D=>({name:D.name,color:b.colors.bullet[D.type]})))}function A(c){c.markers.template.setAll({width:10,height:10}),c.labels.template.setAll({fontSize:"0.8rem",fontWeight:"300"}),c.itemContainers.template.setAll({paddingTop:5,paddingBottom:5})}return Ze(async()=>{if(t.value)try{s.value=et.new(t.value);const{value:c}=s;if(!c)return;c._logo?.dispose(),k(c);const T=await I(),p=y(c);p.set("zoomControl",$.new(c,{})),p.chartContainer.get("background")?.events.on("click",function(){p.goHome()}),w(c,p,T),O(c,p),Q(c,p),await p.appear(1e3,100)}catch(c){console.error("Ошибка инициализации карты:",c)}}),Qe(()=>{s.value?.dispose()}),(c,T)=>(H(),oe("div",{ref_key:"rootDiv",ref:t,style:Ee(Z(m)),class:Re(["map-container",{loading:Z(o)||Z(u).geo,error:e.value}])},[Z(o)||Z(u).geo?(H(),De(Le,{key:0,color:"primary",size:"xl",class:"absolute-center"})):ue("",!0),e.value?(H(),oe("div",At,[h(Ae,{"inline-actions":"",class:"text-white bg-red"},{default:g(()=>[z(Be(e.value),1)]),_:1})])):ue("",!0)],6))}}),Nt=Te(Mt,[["__scopeId","data-v-8d3ea1c5"]]),Zt={class:"absolute gt-xs",style:{top:"1.5rem",right:"1.5rem"}},Qt=le({__name:"AboutHrButton",setup(i){const r=ne(!1);return(e,t)=>(H(),oe(qe,null,[Y("div",Zt,[h(ce,{icon:Z(Fe),color:"accent",dense:"",flat:"",round:"",size:"md",onClick:t[0]||(t[0]=s=>r.value=!r.value)},{default:g(()=>[h(pt,null,{default:g(()=>t[3]||(t[3]=[z("Образовательные организации на карте")])),_:1})]),_:1},8,["icon"])]),h(yt,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=s=>r.value=s)},{default:g(()=>[h(bt,{class:"bg-grey-2 q-px-sm",style:{"min-height":"300px","min-width":"50vw"}},{default:g(()=>[h(ge,{class:"row items-center q-pb-none"},{default:g(()=>[t[4]||(t[4]=Y("div",{class:"text-subtitle1 text-primary"}," Образовательные организации на карте ",-1)),h(ft),He(h(ce,{icon:Z(Ye),class:"float-right",dense:"",flat:"",round:"",onClick:t[1]||(t[1]=s=>r.value=!1)},null,8,["icon"]),[[mt]])]),_:1}),h(ge,null,{default:g(()=>[h(gt,{bordered:"",class:"text-grey-8",padding:"",separator:""},{default:g(()=>[h(se,null,{default:g(()=>[h(B,{avatar:""},{default:g(()=>[h(U,{color:"positive",rounded:""})]),_:1}),h(B,null,{default:g(()=>[h(R,{class:"text-bold"},{default:g(()=>t[5]||(t[5]=[z("Организации ВО")])),_:1}),h(R,{caption:""},{default:g(()=>t[6]||(t[6]=[z(" Организации, предоставляющие обучение по программам высшего образования ")])),_:1})]),_:1})]),_:1}),h(se,null,{default:g(()=>[h(B,{avatar:""},{default:g(()=>[h(U,{color:"warning",rounded:""})]),_:1}),h(B,null,{default:g(()=>[h(R,{class:"text-bold"},{default:g(()=>t[7]||(t[7]=[z("Организации ДПО")])),_:1}),h(R,{caption:""},{default:g(()=>t[8]||(t[8]=[z(" Организации, предоставляющие обучение по программам дополнительного профессионального образования ")])),_:1})]),_:1})]),_:1}),h(se,null,{default:g(()=>[h(B,{avatar:""},{default:g(()=>[h(U,{color:"primary",rounded:""})]),_:1}),h(B,null,{default:g(()=>[h(R,{class:"text-bold"},{default:g(()=>t[9]||(t[9]=[z("Организации ВО/ДПО")])),_:1}),h(R,{caption:""},{default:g(()=>t[10]||(t[10]=[z(" Организации, предоставляющие обучение по программам как высшего, так и дополнительного профессионального образования ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Bt=Te(Qt,[["__scopeId","data-v-f823ba0a"]]),Rt={class:"row"},ds=le({__name:"HumanResourcesPage",setup(i){return(r,e)=>(H(),De(ze,{padding:""},{default:g(()=>[Y("div",Rt,[e[0]||(e[0]=Y("div",{class:"col-12"},[Y("div",{class:"header-glow text-primary text-h3 text-weight-light q-pr-xl"}," Кадровый потенциал регионов Российской Федерации ")],-1)),h(Nt)]),h(Bt)]),_:1}))}});export{ds as default};
