import{u as at,b as Pe,g as ot,d as it,h as Ge,a as Dt,c as Pt,i as qt,f as Ye,e as Bt}from"./use-key-composition-D1-Dj3qO.js";import{y as qe,C as rt,H as T,z as r,I as ee,S as Lt,bf as Ht,A as g,B as _t,b0 as Et,J as st,W as p,bg as ve,aH as Mt,T as Ae,X as R,bh as Rt,bi as pt,ac as Kt,U as Z,bj as Qt,a5 as $t}from"./index-Bhl6SETv.js";import{Q as jt}from"./QChip-B3IePdsh.js";import{a as Ut,b as zt,Q as Nt}from"./QItem-DIgVajpF.js";import{s as Wt,v as Xt,e as Ze,u as Jt,f as Gt,h as Yt,i as Zt,j as eu,k as tu,p as et,l as uu,r as tt,g as lu,m as nu,n as au,d as ou}from"./position-engine-CD8Qv4MV.js";import{u as iu,a as ru,b as su}from"./use-model-toggle-DypRWqPB.js";import{u as cu,a as du}from"./use-dark-CCCGl-by.js";import{a as fu,u as vu}from"./use-tick-0DdASRGW.js";import{c as mu,d as ut,b as gu,r as hu,Q as yu}from"./QDialog-DwvcyMya.js";import{n as lt}from"./format-hlGAdIUH.js";const Su=qe({name:"QField",inheritAttrs:!1,props:{...Pe,tag:{type:String,default:"label"}},emits:at,setup(){return ot(it({tagProp:!0}))}}),bu=qe({name:"QMenu",inheritAttrs:!1,props:{...Gt,...ru,...cu,...Jt,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Ze},self:{type:String,validator:Ze},offset:{type:Array,validator:Xt},scrollTarget:Wt,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...iu,"click","escapeKey"],setup(e,{slots:y,emit:i,attrs:I}){let F=null,s,V,f;const h=rt(),{proxy:L}=h,{$q:w}=L,S=T(null),b=T(!1),te=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),x=du(e,w),{registerTick:K,removeTick:A}=fu(),{registerTimeout:Q}=vu(),{transitionProps:me,transitionStyle:P}=Yt(e),{localScrollTarget:ue,changeScrollEvent:ke,unconfigureScrollTarget:k}=Zt(e,Se),{anchorEl:D,canShow:le}=eu({showing:b}),{hide:ne}=su({showing:b,canShow:le,handleShow:ye,handleHide:n,hideOnRouteChange:te,processOnMount:!0}),{showPortal:ae,hidePortal:oe,renderPortal:q}=tu(h,S,_,"menu"),ie={anchorEl:D,innerRef:S,onClickOutside(a){if(e.persistent!==!0&&b.value===!0)return ne(a),(a.type==="touchstart"||a.target.classList.contains("q-dialog__backdrop"))&&p(a),!0}},ge=r(()=>et(e.anchor||(e.cover===!0?"center middle":"bottom start"),w.lang.rtl)),he=r(()=>e.cover===!0?ge.value:et(e.self||"top start",w.lang.rtl)),re=r(()=>(e.square===!0?" q-menu--square":"")+(x.value===!0?" q-menu--dark q-dark":"")),Ie=r(()=>e.autoClose===!0?{onClick:j}:{}),se=r(()=>b.value===!0&&e.persistent!==!0);ee(se,a=>{a===!0?(mu(ce),uu(ie)):(ut(ce),tt(ie))});function $(){ou(()=>{let a=S.value;a&&a.contains(document.activeElement)!==!0&&(a=a.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.querySelector("[autofocus], [data-autofocus]")||a,a.focus({preventScroll:!0}))})}function ye(a){if(F=e.noRefocus===!1?document.activeElement:null,gu(U),ae(),Se(),s=void 0,a!==void 0&&(e.touchPosition||e.contextMenu)){const z=Lt(a);if(z.left!==void 0){const{top:de,left:we}=D.value.getBoundingClientRect();s={left:z.left-we,top:z.top-de}}}V===void 0&&(V=ee(()=>w.screen.width+"|"+w.screen.height+"|"+e.self+"|"+e.anchor+"|"+w.lang.rtl,H)),e.noFocus!==!0&&document.activeElement.blur(),K(()=>{H(),e.noFocus!==!0&&$()}),Q(()=>{w.platform.is.ios===!0&&(f=e.autoClose,S.value.click()),H(),ae(!0),i("show",a)},e.transitionDuration)}function n(a){A(),oe(),v(!0),F!==null&&(a===void 0||a.qClickOutside!==!0)&&(((a?.type.indexOf("key")===0?F.closest('[tabindex]:not([tabindex^="-"])'):void 0)||F).focus(),F=null),Q(()=>{oe(!0),i("hide",a)},e.transitionDuration)}function v(a){s=void 0,V!==void 0&&(V(),V=void 0),(a===!0||b.value===!0)&&(hu(U),k(),tt(ie),ut(ce)),a!==!0&&(F=null)}function Se(){(D.value!==null||e.scrollTarget!==void 0)&&(ue.value=lu(D.value,e.scrollTarget),ke(ue.value,H))}function j(a){f!==!0?(nu(L,a),i("click",a)):f=!1}function U(a){se.value===!0&&e.noFocus!==!0&&Ht(S.value,a.target)!==!0&&$()}function ce(a){e.noEscDismiss!==!0&&(i("escapeKey"),ne(a))}function H(){au({targetEl:S.value,offset:e.offset,anchorEl:D.value,anchorOrigin:ge.value,selfOrigin:he.value,absoluteOffset:s,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function _(){return g(Et,me.value,()=>b.value===!0?g("div",{role:"menu",...I,ref:S,tabindex:-1,class:["q-menu q-position-engine scroll"+re.value,I.class],style:[I.style,P.value],...Ie.value},_t(y.default)):null)}return st(v),Object.assign(L,{focus:$,updatePosition:H}),q}}),nt=e=>["add","add-unique","toggle"].includes(e),Cu=".*+?^${}()|[]\\",Vu=Object.keys(Pe);function De(e,y){if(typeof e=="function")return e;const i=e!==void 0?e:y;return I=>I!==null&&typeof I=="object"&&i in I?I[i]:I}const qu=qe({name:"QSelect",inheritAttrs:!1,props:{...Ge,...Dt,...Pe,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:nt},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:Ge.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...at,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:y,emit:i}){const{proxy:I}=rt(),{$q:F}=I,s=T(!1),V=T(!1),f=T(-1),h=T(""),L=T(!1),w=T(!1);let S=null,b=null,te,x,K,A=null,Q,me,P,ue;const ke=T(null),k=T(null),D=T(null),le=T(null),ne=T(null),ae=Pt(e),oe=Bt(ze),q=r(()=>Array.isArray(e.options)?e.options.length:0),ie=r(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:ge,virtualScrollSliceSizeComputed:he,localResetVirtualScroll:re,padVirtualScroll:Ie,onVirtualScrollEvt:se,scrollTo:$,setVirtualScrollSize:ye}=qt({virtualScrollLength:q,getVirtualScrollTarget:yt,getVirtualScrollEl:je,virtualScrollItemSizeComputed:ie}),n=it(),v=r(()=>{const t=e.mapOptions===!0&&e.multiple!==!0,u=e.modelValue!==void 0&&(e.modelValue!==null||t===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const l=e.mapOptions===!0&&te!==void 0?te:[],o=u.map(d=>ht(d,l));return e.modelValue===null&&t===!0?o.filter(d=>d!==null):o}return u}),Se=r(()=>{const t={};return Vu.forEach(u=>{const l=e[u];l!==void 0&&(t[u]=l)}),t}),j=r(()=>e.optionsDark===null?n.isDark.value:e.optionsDark),U=r(()=>Ye(v.value)),ce=r(()=>{let t="q-field__input q-placeholder col";return e.hideSelected===!0||v.value.length===0?[t,e.inputClass]:(t+=" q-field__input--padding",e.inputClass===void 0?t:[t,e.inputClass])}),H=r(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),_=r(()=>q.value===0),a=r(()=>v.value.map(t=>O.value(t)).join(", ")),z=r(()=>e.displayValue!==void 0?e.displayValue:a.value),de=r(()=>e.optionsHtml===!0?()=>!0:t=>t?.html===!0),we=r(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||v.value.some(de.value))),Be=r(()=>n.focused.value===!0?e.tabindex:-1),Le=r(()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":s.value===!0?"true":"false","aria-controls":`${n.targetUid.value}_lb`};return f.value>=0&&(t["aria-activedescendant"]=`${n.targetUid.value}_${f.value}`),t}),He=r(()=>({id:`${n.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),_e=r(()=>v.value.map((t,u)=>({index:u,opt:t,html:de.value(t),selected:!0,removeAtIndex:gt,toggleOption:E,tabindex:Be.value}))),ct=r(()=>{if(q.value===0)return[];const{from:t,to:u}=ge.value;return e.options.slice(t,u).map((l,o)=>{const d=N.value(l)===!0,c=Oe(l)===!0,C=t+o,m={clickable:!0,active:c,activeClass:vt.value,manualFocus:!0,focused:!1,disable:d,tabindex:-1,dense:e.optionsDense,dark:j.value,role:"option","aria-selected":c===!0?"true":"false",id:`${n.targetUid.value}_${C}`,onClick:()=>{E(l)}};return d!==!0&&(f.value===C&&(m.focused=!0),F.platform.is.desktop===!0&&(m.onMousemove=()=>{s.value===!0&&W(C)})),{index:C,opt:l,html:de.value(l),label:O.value(l),selected:m.active,focused:m.focused,toggleOption:E,setOptionIndex:W,itemProps:m}})}),dt=r(()=>e.dropdownIcon!==void 0?e.dropdownIcon:F.iconSet.arrow.dropdown),ft=r(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),vt=r(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),B=r(()=>De(e.optionValue,"value")),O=r(()=>De(e.optionLabel,"label")),N=r(()=>De(e.optionDisable,"disable")),be=r(()=>v.value.map(B.value)),mt=r(()=>{const t={onInput:ze,onChange:oe,onKeydown:$e,onKeyup:Ke,onKeypress:Qe,onFocus:Re,onClick(u){x===!0&&Z(u)}};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=oe,t});ee(v,t=>{te=t,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&n.innerLoading.value!==!0&&(V.value!==!0&&s.value!==!0||U.value!==!0)&&(K!==!0&&Y(),(V.value===!0||s.value===!0)&&X(""))},{immediate:!0}),ee(()=>e.fillInput,Y),ee(s,Te),ee(q,At);function Ee(t){return e.emitValue===!0?B.value(t):t}function xe(t){if(t!==-1&&t<v.value.length)if(e.multiple===!0){const u=e.modelValue.slice();i("remove",{index:t,value:u.splice(t,1)[0]}),i("update:modelValue",u)}else i("update:modelValue",null)}function gt(t){xe(t),n.focus()}function Me(t,u){const l=Ee(t);if(e.multiple!==!0){e.fillInput===!0&&fe(O.value(t),!0,!0),i("update:modelValue",l);return}if(v.value.length===0){i("add",{index:0,value:l}),i("update:modelValue",e.multiple===!0?[l]:l);return}if(u===!0&&Oe(t)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const o=e.modelValue.slice();i("add",{index:o.length,value:l}),o.push(l),i("update:modelValue",o)}function E(t,u){if(n.editable.value!==!0||t===void 0||N.value(t)===!0)return;const l=B.value(t);if(e.multiple!==!0){u!==!0&&(fe(e.fillInput===!0?O.value(t):"",!0,!0),M()),k.value?.focus(),(v.value.length===0||ve(B.value(v.value[0]),l)!==!0)&&i("update:modelValue",e.emitValue===!0?l:t);return}if((x!==!0||L.value===!0)&&n.focus(),Re(),v.value.length===0){const c=e.emitValue===!0?l:t;i("add",{index:0,value:c}),i("update:modelValue",e.multiple===!0?[c]:c);return}const o=e.modelValue.slice(),d=be.value.findIndex(c=>ve(c,l));if(d!==-1)i("remove",{index:d,value:o.splice(d,1)[0]});else{if(e.maxValues!==void 0&&o.length>=e.maxValues)return;const c=e.emitValue===!0?l:t;i("add",{index:o.length,value:c}),o.push(c)}i("update:modelValue",o)}function W(t){if(F.platform.is.desktop!==!0)return;const u=t!==-1&&t<q.value?t:-1;f.value!==u&&(f.value=u)}function Ce(t=1,u){if(s.value===!0){let l=f.value;do l=lt(l+t,-1,q.value-1);while(l!==-1&&l!==f.value&&N.value(e.options[l])===!0);f.value!==l&&(W(l),$(l),u!==!0&&e.useInput===!0&&e.fillInput===!0&&Ve(l>=0?O.value(e.options[l]):Q,!0))}}function ht(t,u){const l=o=>ve(B.value(o),t);return e.options.find(l)||u.find(l)||t}function Oe(t){const u=B.value(t);return be.value.find(l=>ve(l,u))!==void 0}function Re(t){e.useInput===!0&&k.value!==null&&(t===void 0||k.value===t.target&&t.target.value===a.value)&&k.value.select()}function pe(t){Qt(t,27)===!0&&s.value===!0&&(Z(t),M(),Y()),i("keyup",t)}function Ke(t){const{value:u}=t.target;if(t.keyCode!==void 0){pe(t);return}if(t.target.value="",S!==null&&(clearTimeout(S),S=null),b!==null&&(clearTimeout(b),b=null),Y(),typeof u=="string"&&u.length!==0){const l=u.toLocaleLowerCase(),o=c=>{const C=e.options.find(m=>String(c.value(m)).toLocaleLowerCase()===l);return C===void 0?!1:(v.value.indexOf(C)===-1?E(C):M(),!0)},d=c=>{o(B)!==!0&&c!==!0&&o(O)!==!0&&X(u,!0,()=>d(!0))};d()}else n.clearValue(t)}function Qe(t){i("keypress",t)}function $e(t){if(i("keydown",t),Mt(t)===!0)return;const u=h.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),l=t.shiftKey!==!0&&e.disableTabSelection!==!0&&e.multiple!==!0&&(f.value!==-1||u===!0);if(t.keyCode===27){Ae(t);return}if(t.keyCode===9&&l===!1){J();return}if(t.target===void 0||t.target.id!==n.targetUid.value||n.editable.value!==!0)return;if(t.keyCode===40&&n.innerLoading.value!==!0&&s.value===!1){p(t),G();return}if(t.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&h.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?xe(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&i("update:modelValue",null);return}(t.keyCode===35||t.keyCode===36)&&(typeof h.value!="string"||h.value.length===0)&&(p(t),f.value=-1,Ce(t.keyCode===36?1:-1,e.multiple)),(t.keyCode===33||t.keyCode===34)&&he.value!==void 0&&(p(t),f.value=Math.max(-1,Math.min(q.value,f.value+(t.keyCode===33?-1:1)*he.value.view)),Ce(t.keyCode===33?1:-1,e.multiple)),(t.keyCode===38||t.keyCode===40)&&(p(t),Ce(t.keyCode===38?-1:1,e.multiple));const o=q.value;if((P===void 0||ue<Date.now())&&(P=""),o>0&&e.useInput!==!0&&t.key!==void 0&&t.key.length===1&&t.altKey===!1&&t.ctrlKey===!1&&t.metaKey===!1&&(t.keyCode!==32||P.length!==0)){s.value!==!0&&G(t);const d=t.key.toLocaleLowerCase(),c=P.length===1&&P[0]===d;ue=Date.now()+1500,c===!1&&(p(t),P+=d);const C=new RegExp("^"+P.split("").map(Fe=>Cu.indexOf(Fe)!==-1?"\\"+Fe:Fe).join(".*"),"i");let m=f.value;if(c===!0||m<0||C.test(O.value(e.options[m]))!==!0)do m=lt(m+1,-1,o-1);while(m!==f.value&&(N.value(e.options[m])===!0||C.test(O.value(e.options[m]))!==!0));f.value!==m&&R(()=>{W(m),$(m),m>=0&&e.useInput===!0&&e.fillInput===!0&&Ve(O.value(e.options[m]),!0)});return}if(!(t.keyCode!==13&&(t.keyCode!==32||e.useInput===!0||P!=="")&&(t.keyCode!==9||l===!1))){if(t.keyCode!==9&&p(t),f.value!==-1&&f.value<o){E(e.options[f.value]);return}if(u===!0){const d=(c,C)=>{if(C){if(nt(C)!==!0)return}else C=e.newValueMode;if(fe("",e.multiple!==!0,!0),c==null)return;(C==="toggle"?E:Me)(c,C==="add-unique"),e.multiple!==!0&&(k.value?.focus(),M())};if(e.onNewValue!==void 0?i("newValue",h.value,d):d(h.value),e.multiple!==!0)return}s.value===!0?J():n.innerLoading.value!==!0&&G()}}function je(){return x===!0?ne.value:D.value!==null&&D.value.contentEl!==null?D.value.contentEl:void 0}function yt(){return je()}function St(){return e.hideSelected===!0?[]:y["selected-item"]!==void 0?_e.value.map(t=>y["selected-item"](t)).slice():y.selected!==void 0?[].concat(y.selected()):e.useChips===!0?_e.value.map((t,u)=>g(jt,{key:"option-"+u,removable:n.editable.value===!0&&N.value(t.opt)!==!0,dense:!0,textColor:e.color,tabindex:Be.value,onRemove(){t.removeAtIndex(u)}},()=>g("span",{class:"ellipsis",[t.html===!0?"innerHTML":"textContent"]:O.value(t.opt)}))):[g("span",{class:"ellipsis",[we.value===!0?"innerHTML":"textContent"]:z.value})]}function Ue(){if(_.value===!0)return y["no-option"]!==void 0?y["no-option"]({inputValue:h.value}):void 0;const t=y.option!==void 0?y.option:l=>g(Nt,{key:l.index,...l.itemProps},()=>g(Ut,()=>g(zt,()=>g("span",{[l.html===!0?"innerHTML":"textContent"]:l.label}))));let u=Ie("div",ct.value.map(t));return y["before-options"]!==void 0&&(u=y["before-options"]().concat(u)),$t(y["after-options"],u)}function bt(t,u){const l=u===!0?{...Le.value,...n.splitAttrs.attributes.value}:void 0,o={ref:u===!0?k:void 0,key:"i_t",class:ce.value,style:e.inputStyle,value:h.value!==void 0?h.value:"",type:"search",...l,id:u===!0?n.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":t===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...mt.value};return t!==!0&&x===!0&&(Array.isArray(o.class)===!0?o.class=[...o.class,"no-pointer-events"]:o.class+=" no-pointer-events"),g("input",o)}function ze(t){S!==null&&(clearTimeout(S),S=null),b!==null&&(clearTimeout(b),b=null),!(t&&t.target&&t.target.qComposing===!0)&&(Ve(t.target.value||""),K=!0,Q=h.value,n.focused.value!==!0&&(x!==!0||L.value===!0)&&n.focus(),e.onFilter!==void 0&&(S=setTimeout(()=>{S=null,X(h.value)},e.inputDebounce)))}function Ve(t,u){h.value!==t&&(h.value=t,u===!0||e.inputDebounce===0||e.inputDebounce==="0"?i("inputValue",t):b=setTimeout(()=>{b=null,i("inputValue",t)},e.inputDebounce))}function fe(t,u,l){K=l!==!0,e.useInput===!0&&(Ve(t,!0),(u===!0||l!==!0)&&(Q=t),u!==!0&&X(t))}function X(t,u,l){if(e.onFilter===void 0||u!==!0&&n.focused.value!==!0)return;n.innerLoading.value===!0?i("filterAbort"):(n.innerLoading.value=!0,w.value=!0),t!==""&&e.multiple!==!0&&v.value.length!==0&&K!==!0&&t===O.value(v.value[0])&&(t="");const o=setTimeout(()=>{s.value===!0&&(s.value=!1)},10);A!==null&&clearTimeout(A),A=o,i("filter",t,(d,c)=>{(u===!0||n.focused.value===!0)&&A===o&&(clearTimeout(A),typeof d=="function"&&d(),w.value=!1,R(()=>{n.innerLoading.value=!1,n.editable.value===!0&&(u===!0?s.value===!0&&M():s.value===!0?Te(!0):s.value=!0),typeof c=="function"&&R(()=>{c(I)}),typeof l=="function"&&R(()=>{l(I)})}))},()=>{n.focused.value===!0&&A===o&&(clearTimeout(A),n.innerLoading.value=!1,w.value=!1),s.value===!0&&(s.value=!1)})}function Ct(){return g(bu,{ref:D,class:H.value,style:e.popupContentStyle,modelValue:s.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&_.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:j.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:ft.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...He.value,onScrollPassive:se,onBeforeShow:We,onBeforeHide:Vt,onShow:kt},Ue)}function Vt(t){Xe(t),J()}function kt(){ye()}function It(t){Z(t),k.value?.focus(),L.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function wt(t){Z(t),R(()=>{L.value=!1})}function xt(){const t=[g(Su,{class:`col-auto ${n.fieldClass.value}`,...Se.value,for:n.targetUid.value,dark:j.value,square:!0,loading:w.value,itemAligned:!1,filled:!0,stackLabel:h.value.length!==0,...n.splitAttrs.listeners.value,onFocus:It,onBlur:wt},{...y,rawControl:()=>n.getControl(!0),before:void 0,after:void 0})];return s.value===!0&&t.push(g("div",{ref:ne,class:H.value+" scroll",style:e.popupContentStyle,...He.value,onClick:Ae,onScrollPassive:se},Ue())),g(yu,{ref:le,modelValue:V.value,position:e.useInput===!0?"top":void 0,transitionShow:me,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:We,onBeforeHide:Ot,onHide:Tt,onShow:Ft},()=>g("div",{class:"q-select__dialog"+(j.value===!0?" q-select__dialog--dark q-dark":"")+(L.value===!0?" q-select__dialog--focused":"")},t))}function Ot(t){Xe(t),le.value!==null&&le.value.__updateRefocusTarget(n.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),n.focused.value=!1}function Tt(t){M(),n.focused.value===!1&&i("blur",t),Y()}function Ft(){const t=document.activeElement;(t===null||t.id!==n.targetUid.value)&&k.value!==null&&k.value!==t&&k.value.focus(),ye()}function J(){V.value!==!0&&(f.value=-1,s.value===!0&&(s.value=!1),n.focused.value===!1&&(A!==null&&(clearTimeout(A),A=null),n.innerLoading.value===!0&&(i("filterAbort"),n.innerLoading.value=!1,w.value=!1)))}function G(t){n.editable.value===!0&&(x===!0?(n.onControlFocusin(t),V.value=!0,R(()=>{n.focus()})):n.focus(),e.onFilter!==void 0?X(h.value):(_.value!==!0||y["no-option"]!==void 0)&&(s.value=!0))}function M(){V.value=!1,J()}function Y(){e.useInput===!0&&fe(e.multiple!==!0&&e.fillInput===!0&&v.value.length!==0&&O.value(v.value[0])||"",!0,!0)}function Te(t){let u=-1;if(t===!0){if(v.value.length!==0){const l=B.value(v.value[0]);u=e.options.findIndex(o=>ve(B.value(o),l))}re(u)}W(u)}function At(t,u){s.value===!0&&n.innerLoading.value===!1&&(re(-1,!0),R(()=>{s.value===!0&&n.innerLoading.value===!1&&(t>u?re():Te(!0))}))}function Ne(){V.value===!1&&D.value!==null&&D.value.updatePosition()}function We(t){t!==void 0&&Z(t),i("popupShow",t),n.hasPopupOpen=!0,n.onControlFocusin(t)}function Xe(t){t!==void 0&&Z(t),i("popupHide",t),n.hasPopupOpen=!1,n.onControlFocusout(t)}function Je(){x=F.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?y["no-option"]!==void 0||e.onFilter!==void 0||_.value===!1:!0),me=F.platform.is.ios===!0&&x===!0&&e.useInput===!0?"fade":e.transitionShow}return Rt(Je),pt(Ne),Je(),st(()=>{S!==null&&clearTimeout(S),b!==null&&clearTimeout(b)}),Object.assign(I,{showPopup:G,hidePopup:M,removeAtIndex:xe,add:Me,toggleOption:E,getOptionIndex:()=>f.value,setOptionIndex:W,moveOptionSelection:Ce,filter:X,updateMenuPosition:Ne,updateInputValue:fe,isOptionSelected:Oe,getEmittingOptionValue:Ee,isOptionDisabled:(...t)=>N.value.apply(null,t)===!0,getOptionValue:(...t)=>B.value.apply(null,t),getOptionLabel:(...t)=>O.value.apply(null,t)}),Object.assign(n,{innerValue:v,fieldClass:r(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:ke,targetRef:k,hasValue:U,showPopup:G,floatingLabel:r(()=>e.hideSelected!==!0&&U.value===!0||typeof h.value=="number"||h.value.length!==0||Ye(e.displayValue)),getControlChild:()=>{if(n.editable.value!==!1&&(V.value===!0||_.value!==!0||y["no-option"]!==void 0))return x===!0?xt():Ct();n.hasPopupOpen===!0&&(n.hasPopupOpen=!1)},controlEvents:{onFocusin(t){n.onControlFocusin(t)},onFocusout(t){n.onControlFocusout(t,()=>{Y(),J()})},onClick(t){if(Ae(t),x!==!0&&s.value===!0){J(),k.value?.focus();return}G(t)}},getControl:t=>{const u=St(),l=t===!0||V.value!==!0||x!==!0;if(e.useInput===!0)u.push(bt(t,l));else if(n.editable.value===!0){const d=l===!0?Le.value:void 0;u.push(g("input",{ref:l===!0?k:void 0,key:"d_t",class:"q-select__focus-target",id:l===!0?n.targetUid.value:void 0,value:z.value,readonly:!0,"data-autofocus":t===!0||e.autofocus===!0||void 0,...d,onKeydown:$e,onKeyup:pe,onKeypress:Qe})),l===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&u.push(g("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:Ke}))}if(ae.value!==void 0&&e.disable!==!0&&be.value.length!==0){const d=be.value.map(c=>g("option",{value:c,selected:!0}));u.push(g("select",{class:"hidden",name:ae.value,multiple:e.multiple},d))}const o=e.useInput===!0||l!==!0?void 0:n.splitAttrs.attributes.value;return g("div",{class:"q-field__native row items-center",...o,...n.splitAttrs.listeners.value},u)},getInnerAppend:()=>e.loading!==!0&&w.value!==!0&&e.hideDropdownIcon!==!0?[g(Kt,{class:"q-select__dropdown-icon"+(s.value===!0?" rotate-180":""),name:dt.value})]:null}),ot(n)}});export{qu as Q};
