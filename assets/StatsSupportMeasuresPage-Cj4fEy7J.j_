import{Q as N}from"./QCard-4hNWPW3w.js";import{Q as E}from"./QBanner-Bh0a8mRE.js";import{Q as R}from"./QSpinnerDots-B_-BC47s.js";import{u as S}from"./useK8Data-BuIaItK5.js";import{H as v,z as T,a6 as A,Y as M,aq as t,ap as o,ak as i,ab as x,a9 as h,ax as k,ar as z,a8 as a,aa as C,ae as D,ad as L}from"./index-Bhl6SETv.js";import"./use-dark-CCCGl-by.js";const d=new Map,V=60*60*1e3;let b=0;const j=()=>{const c=v(null),p=v(!1),l=v(null),f=()=>d.size>0&&Date.now()-b<V,_=()=>{!f()&&d.size>0&&(d.clear(),b=0)},y=async(s,m=!1)=>{if(!s||typeof s!="string"){l.value={type:"INVALID_PARAM",message:"Некорректный ID региона"};return}if(_(),!m&&f()&&d.has(s)){c.value=d.get(s)||null;return}p.value=!0,l.value=null;try{const e=await fetch("data/specialization_data.json");if(!e.ok)throw{type:"NETWORK",message:`Ошибка сервера: ${e.status} ${e.statusText}`};const u=await e.json();if(b=Date.now(),Object.entries(u).forEach(([r,n])=>{d.set(r,n)}),c.value=u[s]||null,!c.value)throw{type:"NOT_FOUND",message:"Данные о специализации региона не найдены"}}catch(e){e&&typeof e=="object"&&"type"in e&&"message"in e?l.value=e:l.value={type:"INVALID_DATA",message:e instanceof Error?e.message:"Неизвестная ошибка"},c.value=null}finally{p.value=!1}},g=T(()=>l.value?.message||null);return{loading:p,error:l,errorMessage:g,specialization:c,fetchRegionSpecialization:y,refreshRegionSpecialization:s=>y(s,!0)}},Q={key:0},q={key:0,class:"row items-start justify-between q-gutter-sm"},O={class:"col-12"},B={key:0},H={key:1},I=["innerHTML"],P={key:1,class:"flex flex-center text-grey-6"},K={key:1,class:"flex flex-center text-grey-6"},F={key:2,class:"flex flex-center"},J=A({__name:"StatsSupportMeasuresPage",props:{id:{}},setup(c){const p=c,{loading:l,error:f,fetchK8RegionData:_}=S(),{loading:y,errorMessage:g,fetchRegionSpecialization:w,specialization:s}=j(),m=v([]),e=v(!0);return M(async()=>{e.value=!0;try{const[u]=await Promise.all([_(p.id),w(p.id)]);m.value=u}catch(u){console.error("Error loading data:",u)}finally{e.value=!1}}),(u,r)=>(a(),t("div",null,[r[4]||(r[4]=o("div",{class:"text-h5 text-info q-mb-md"}," Отрасли экономической специализации и меры поддержки региона ",-1)),!i(l)&&!i(y)&&!e.value?(a(),t("div",Q,[i(s)&&m.value.length>0?(a(),t("div",q,[o("div",O,[r[2]||(r[2]=o("div",{class:"text-subtitle2 text-primary"}," Отрасли экономической специализации ",-1)),x(N,{bordered:"",class:"q-pa-md",flat:""},{default:h(()=>[i(s).perspective?.length?(a(),t("div",B,[r[0]||(r[0]=o("div",{class:"text-subtitle2 text-primary"}," Перспективная экономическая специализация: ",-1)),o("ul",null,[(a(!0),t(k,null,z(i(s).perspective,n=>(a(),t("li",{key:n},D(n),1))),128))])])):C("",!0),i(s).non_perspective?.length?(a(),t("div",H,[r[1]||(r[1]=o("div",{class:"text-subtitle2 text-primary"}," Неперспективная экономическая специализация, критически важная для региона: ",-1)),o("ul",null,[(a(!0),t(k,null,z(i(s).non_perspective,n=>(a(),t("li",{key:n},D(n),1))),128))])])):C("",!0)]),_:1})]),(a(!0),t(k,null,z(m.value,n=>(a(),t("div",{key:n.year,class:"col-12"},[r[3]||(r[3]=o("div",{class:"text-subtitle2 text-primary"},"Меры поддержки",-1)),x(N,{bordered:"",class:"q-pa-md",flat:""},{default:h(()=>[o("div",{innerHTML:n.support_measures},null,8,I)]),_:2},1024)]))),128))])):(a(),t("div",P," Данные об отраслях экономической специализации и мерах поддержки региона не найдены "))])):i(f)||i(g)?(a(),t("div",K,[x(E,{class:"bg-negative text-white"},{default:h(()=>[L(D(i(f)||i(g)),1)]),_:1})])):(a(),t("div",F,[x(R,{color:"primary",size:"xl"})]))]))}});export{J as default};
